{"index": 9753, "cve_id": "CVE-2022-4859", "cwe_id": ["CWE-79"], "cve_language": "Java", "cve_description": "A vulnerability, which was classified as problematic, has been found in Joget up to 7.0.33. This issue affects the function submitForm of the file wflow-core/src/main/java/org/joget/plugin/enterprise/UserProfileMenu.java of the component User Profile Menu. The manipulation of the argument firstName/lastName leads to cross site scripting. The attack may be initiated remotely. Upgrading to version 7.0.34 is able to address this issue. The patch is named 9a77f508a2bf8cf661d588f37a4cc29ecaea4fc8. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-217055.", "cvss": "6.1", "publish_date": "December 30, 2022", "AV": "NETWORK", "AC": "NETWORK", "PR": "NONE", "UI": "REQUIRED", "S": "CHANGED", "C": "LOW", "I": "LOW", "A": "NONE", "commit_id": "9a77f508a2bf8cf661d588f37a4cc29ecaea4fc8", "commit_message": "Fixed: wflow-core - User Profile Menu - Prevent XSS. T1604 @7.0-SNAPSHOT", "commit_date": "2022-11-23T01:04:01Z", "project": "jogetworkflow/jw-community", "url": "https://api.github.com/repos/jogetworkflow/jw-community/commits/9a77f508a2bf8cf661d588f37a4cc29ecaea4fc8", "html_url": "https://github.com/jogetworkflow/jw-community/commit/9a77f508a2bf8cf661d588f37a4cc29ecaea4fc8", "windows_before": [{"commit_id": "2e33ea3bcaf33fd554a2cb5323b7ecf58975236a", "commit_date": "Tue Nov 22 14:04:32 2022 +0800", "commit_message": "Fixed: wflow-core - Form Section Visibility - fails if on checkbox set to readonly. @7.0-SNAPSHOT #T1624", "files_name": ["wflow-core/src/main/resources/resources/js/section.js", "wflow-core/src/main/resources/templates/checkBox.ftl"]}, {"commit_id": "473338a6f0da56f6df23dfee2685c0c6ee0f7622", "commit_date": "Wed Nov 16 08:24:23 2022 +0800", "commit_message": "Fixed: jw-community - Update csrfguard to 4.2.0 & commons-lang3 to 3.12.0 for CVE-2021-28490. @8.0-SNAPSHOT", "files_name": ["wflow-commons/pom.xml", "wflow-commons/src/main/java/org/joget/commons/util/CsrfGuardLogger.java", "wflow-consoleweb/src/main/java/org/owasp/csrfguard/servlet/JavaScriptServlet.java", "wflow-consoleweb/src/main/resources/Owasp.CsrfGuard.properties", "wflow-core/pom.xml"]}, {"commit_id": "28d803e14ab70fd3e3d8dd65aa2d9320ecba9d05", "commit_date": "Thu Oct 27 09:28:53 2022 +0800", "commit_message": "Modified: wflow-core - UI Theme - Retrieve menu count in separated AJAX call. @7.0-SNAPSHOT", "files_name": ["wflow-consoleweb/src/main/resources/wro.xml", "wflow-consoleweb/src/main/webapp/js/ajax-menus-count.js", "wflow-consoleweb/src/main/webapp/xadmin/js/xadminExt.js", "wflow-core/src/main/java/org/joget/apps/userview/model/UserviewV5Theme.java", "wflow-core/src/main/java/org/joget/apps/userview/service/UserviewThemeProcesser.java", "wflow-core/src/main/java/org/joget/plugin/enterprise/XadminTheme.java", "wflow-core/src/main/resources/templates/userview/ajax_menus_count.ftl"]}, {"commit_id": "502a8b2ba6981557c2784a2dc1b048581dcc2461", "commit_date": "Tue Nov 15 14:45:08 2022 +0800", "commit_message": "Fixed: wflow-consoleweb - Fixed CSS issues when in RTL mode. @8.0-SNAPSHOT.", "files_name": ["wflow-consoleweb/src/main/resources/console_ar.properties", "wflow-consoleweb/src/main/webapp/builder/builder.js", "wflow-consoleweb/src/main/webapp/css/admin_bar.css", "wflow-consoleweb/src/main/webapp/css/jquery.propertyeditor.css", "wflow-consoleweb/src/main/webapp/css/jquery.propertyeditor_rtl.css", "wflow-consoleweb/src/main/webapp/css/rtl.css", "wflow-consoleweb/src/main/webapp/js/chosen/chosen.css", "wflow-consoleweb/src/main/webapp/js/jquery/flexigrid/flexigrid.js"]}, {"commit_id": "3c0ba2094eda30153c69dd1f00e6097796fb1132", "commit_date": "Mon Nov 14 16:34:44 2022 +0800", "commit_message": "Fixed: wflow-wfengine - WorkflowManager - XPDL return null in multitenant environment. @7.0-SNAPSHOT", "files_name": ["wflow-wfengine/src/main/java/org/joget/workflow/model/service/WorkflowManagerImpl.java"]}, {"commit_id": "bd6ceca0f2e748533f03a9707427e9bdb9c2852b", "commit_date": "Mon Nov 14 12:28:00 2022 +0800", "commit_message": "Merge branch '7.0-SNAPSHOT' of ssh://repo.joget.org:2224/joget/jw-community into 7.0-SNAPSHOT", "files_name": ["977fe76b290cce5489b3ea01fae03e35abfe0014 - Mon Nov 14 12:22:27 2022 +0800 : Fixed: wflow-core - AppDevUtil - Git having file permission issue during heavy concurrent requests on multitenant environment. @7.0-SNAPSHOT", "wflow-core/src/main/java/org/joget/apps/app/service/AppDevUtil.java"]}, {"commit_id": "5bbaadaf5dab5d3a1ad3d81cfc7a2439cfa6c823", "commit_date": "Wed Nov 9 09:23:02 2022 +0800", "commit_message": "Merge branch '8.0-SNAPSHOT' of ssh://repo.joget.org:2224/joget/jw-community into 8.0-SNAPSHOT", "files_name": ["0f3c88255a38e5eb78670a86139aa366fae41554 - Tue Nov 8 21:13:08 2022 +0800 : Modified: wflow-core - Tensorflow Plugin - Update protobuf-java to 3.21.9. @8.0-SNAPSHOT", "wflow-core/pom.xml"]}, {"commit_id": "e43f37d9e3fbeee528225152e5075ee3940109d7", "commit_date": "Tue Nov 8 20:30:41 2022 +0800", "commit_message": "Modified: wflow-commons - Update Apache Tomcat JDBC to 9.0.68. @8.0-SNAPSHOT", "files_name": ["wflow-commons/pom.xml"]}, {"commit_id": "045ee9ebc9bf03734bdc08e30ccaca8e8c0ae607", "commit_date": "Tue Nov 8 20:19:06 2022 +0800", "commit_message": "Modified: jw-community - Update jQuery UI to 1.13.2 for CVE-2022-31160. @8.0-SNAPSHOT", "files_name": ["wflow-consoleweb/src/main/resources/wro.xml", "wflow-consoleweb/src/main/webapp/WEB-INF/jsp/pbuilder/pscreenshot.jsp", "wflow-consoleweb/src/main/webapp/css/userview.css", "wflow-consoleweb/src/main/webapp/css/userview8.css", "wflow-consoleweb/src/main/webapp/css/v7.css", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/animated-overlay.gif", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-bg_flat_0_aaaaaa_40x100.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-bg_flat_75_ffffff_40x100.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-bg_glass_55_fbf9ee_1x400.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-bg_glass_65_ffffff_1x400.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-bg_glass_75_dadada_1x400.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-bg_glass_75_e6e6e6_1x400.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-bg_glass_95_fef1ec_1x400.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-bg_highlight-soft_75_fff_1x100.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_222222_256x240.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_2e83ff_256x240.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_444444_256x240.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_454545_256x240.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_555555_256x240.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_777620_256x240.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_777777_256x240.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_888888_256x240.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_cc0000_256x240.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_cd0a0a_256x240.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_ffffff_256x240.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/jquery-ui-1.10.3.custom.min.css", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/jquery-ui.css", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/jquery-ui.min.css", "wflow-consoleweb/src/main/webapp/js/jquery/ui/jquery-ui-1.13.1.min.js", "wflow-consoleweb/src/main/webapp/js/jquery/ui/jquery-ui.js", "wflow-consoleweb/src/main/webapp/js/jquery/ui/jquery-ui.min.js"]}, {"commit_id": "f57bfa97d2ce5425cbfcd9c1ab2fba1439f8e987", "commit_date": "Tue Nov 8 15:58:21 2022 +0800", "commit_message": "Modified: jw-community - Update Spring Framework to 5.3.23, Spring Security to 5.7.5, Spring LDAP to 2.4.1. @8.0-SNAPSHOT", "files_name": ["wflow-commons/pom.xml", "wflow-core/pom.xml", "wflow-directory/pom.xml", "wflow-plugin-base/pom.xml", "wflow-wfengine/pom.xml"]}, {"commit_id": "953e736ad93c0e825be314ea10356bb9ce98d05f", "commit_date": "Mon Nov 7 09:43:30 2022 +0000", "commit_message": "[maven-release-plugin] prepare for next development iteration", "files_name": ["wflow-app/pom.xml", "wflow-commons/pom.xml", "wflow-consoleweb/pom.xml", "wflow-core/pom.xml", "wflow-directory/pom.xml", "wflow-install/pom.xml", "wflow-jdbc/pom.xml", "wflow-plugin-archetype/pom.xml", "wflow-plugin-base/pom.xml", "wflow-wfengine/pom.xml"]}, {"commit_id": "992d5b3fd1201b860882aa3a241e6e36e5af8b34", "commit_date": "Mon Nov 7 09:43:28 2022 +0000", "commit_message": "[maven-release-plugin] prepare release 8.0-BETA", "files_name": ["wflow-app/pom.xml", "wflow-commons/pom.xml", "wflow-consoleweb/pom.xml", "wflow-core/pom.xml", "wflow-directory/pom.xml", "wflow-install/pom.xml", "wflow-jdbc/pom.xml", "wflow-plugin-archetype/pom.xml", "wflow-plugin-base/pom.xml", "wflow-wfengine/pom.xml"]}, {"commit_id": "afa3f8d933b4995ef40adadc23c5dc65bd728087", "commit_date": "Mon Nov 7 17:16:34 2022 +0800", "commit_message": "Modified: wflow-install - Update CHANGES.txt @8.0-SNAPSHOT", "files_name": ["wflow-install/src/main/resources/CHANGES.txt"]}, {"commit_id": "06181e1bd0cc88ef2c8d407e6d86cf21c570dedd", "commit_date": "Mon Nov 7 13:27:04 2022 +0800", "commit_message": "Revert \"Fixed: wflow-consoleweb - App center - Inbox assignment form buttons are missing. @8.0-SNAPSHOT\"", "files_name": ["wflow-consoleweb/src/main/webapp/css/userview8.css"]}, {"commit_id": "3ff1a35304eb6c73881c571c82d584e426a0ab52", "commit_date": "Mon Nov 7 13:22:27 2022 +0800", "commit_message": "Fixed: jw-community - Update app center. @8.0-SNAPSHOT", "files_name": ["wflow-consoleweb/src/main/resources/setup/apps/APP_appcenter7-1.zip", "wflow-consoleweb/src/main/webapp/css/appCenter8.css", "wflow-consoleweb/src/main/webapp/js/appCenter8.js", "wflow-install/src/main/resources/data/jwdb-sample.sql", "wflow-install/src/main/resources/mariadb-data/ib_logfile0", "wflow-install/src/main/resources/mariadb-data/ibdata1", "wflow-install/src/main/resources/mariadb-data/jwdb/app_app.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_app.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_builder.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_builder.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_datalist.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_datalist.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_env_variable.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_env_variable.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_fd.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_fd.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_fd_appcenter.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_fd_appcenter.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_fd_crm_account.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_fd_crm_account.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_fd_crm_contact.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_fd_crm_contact.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_fd_crm_opportunity.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_fd_crm_opportunity.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_fd_crm_proposal.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_fd_crm_proposal.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_form.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_form.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_form_data_audit_trail.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_form_data_audit_trail.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_message.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_message.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_package.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_package.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_package_activity_form.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_package_activity_form.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_package_activity_plugin.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_package_activity_plugin.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_package_participant.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_package_participant.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_plugin_default.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_plugin_default.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_report_activity.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_report_activity.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_report_activity_instance.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_report_activity_instance.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_report_app.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_report_app.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_report_package.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_report_package.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_report_process.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_report_process.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_report_process_instance.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_report_process_instance.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_resource.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_resource.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/app_userview.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/app_userview.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_department.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_department.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_employment.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_employment.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_employment_report_to.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_employment_report_to.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_grade.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_grade.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_group.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_group.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_organization.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_organization.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_role.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_role.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_user.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_user.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_user_extra.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_user_extra.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_user_group.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_user_group.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_user_meta.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_user_meta.ibd", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_user_password_history.frm", "wflow-install/src/main/resources/mariadb-data/jwdb/dir_user_password_history.ibd"]}], "windows_after": [{"commit_id": "9edcf9f16cfd2f229b66e83a4c935d17e9033287", "commit_date": "Fri Nov 25 11:47:16 2022 +0800", "commit_message": "Fixed: wflow-core - Update poi library to 5.2.3. @8.0-SNAPSHOT", "files_name": ["wflow-consoleweb/src/main/java/org/owasp/csrfguard/servlet/JavaScriptServlet.java", "wflow-core/pom.xml", "wflow-core/src/main/java/org/joget/apps/datalist/model/DataListExcelWriter.java"]}, {"commit_id": "b93cced4f3cee50b2bfc72883dbf0d3f6f6c3d8a", "commit_date": "Tue Nov 29 16:23:55 2022 +0800", "commit_message": "Fixed: wflow-core - Form - Store binders under visibility hidden section is still executed. T1640 @7.0-SNAPSHOT", "files_name": ["wflow-core/src/main/java/org/joget/apps/form/service/FormServiceImpl.java"]}, {"commit_id": "b58d33895ae7daf351c93435ee8a83eae7d2d56f", "commit_date": "Tue Nov 29 16:42:52 2022 +0800", "commit_message": "Modified: Removed sql directory from .gitignore @7.0-SNAPSHOT", "files_name": [".gitignore"]}, {"commit_id": "4b80f7455d437f860bbae0b742f484a838bccafe", "commit_date": "Tue Nov 29 16:51:26 2022 +0800", "commit_message": "Merge branch '7.0-SNAPSHOT' into 8.0-SNAPSHOT", "files_name": ["06ff4381e7010328332cfc271fee5a561f985497 - Tue Nov 29 16:54:05 2022 +0800 : Modified: Removed sql directory from .gitignore @8.0-SNAPSHOT", ".gitignore"]}, {"commit_id": "bd49e881da01dcac65bfd3a1c637b6bd6e968433", "commit_date": "Tue Nov 29 17:18:22 2022 +0800", "commit_message": "Added: jw-community - PostgreSQL - Added support for PostgreSQL in the database setup @8.0-SNAPSHOT", "files_name": ["wflow-consoleweb/src/main/java/org/joget/apps/app/web/SetupServlet.java", "wflow-consoleweb/src/main/resources/setup/sql/jwdb-postgres.sql", "wflow-consoleweb/src/main/webapp/WEB-INF/jsp/setup/setup.jsp", "wflow-jdbc/pom.xml"]}, {"commit_id": "a020eaa4d7a9283b80b57c1911a0aeb033bc39a8", "commit_date": "Wed Nov 30 10:54:04 2022 +0800", "commit_message": "Fixed: wflow-consoleweb - Fixed Issue cant find the control field if the target field is on another page level. #T1598 @7.0-SNAPSHOT", "files_name": ["wflow-consoleweb/src/main/webapp/js/jquery/jquery.propertyeditor.js"]}, {"commit_id": "6e2ce04d18b522ac498eef4cc8aea28ac288c7f4", "commit_date": "Wed Nov 30 12:40:35 2022 +0800", "commit_message": "Fixed: wflow-core - User Profile Menu - Validate input length. T1604 @7.0-SNAPSHOT", "files_name": ["wflow-core/src/main/java/org/joget/plugin/enterprise/UserProfileMenu.java"]}, {"commit_id": "5811d1213cb5d859d83d563fbd1bb0457d9d8156", "commit_date": "Thu Dec 1 22:26:48 2022 +0800", "commit_message": "Fixed: wflow-core - Update TinyMCE to 6.3.0  @8.0-SNAPSHOT", "files_name": ["wflow-consoleweb/src/main/webapp/ajaxuniversal/js/main.js", "wflow-consoleweb/src/main/webapp/builder/builder.css", "wflow-consoleweb/src/main/webapp/builder/builder.js", "wflow-consoleweb/src/main/webapp/js/jquery/jquery.propertyeditor.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/CHANGELOG.md", "wflow-consoleweb/src/main/webapp/js/tiny_mce/LICENSE.TXT", "wflow-consoleweb/src/main/webapp/js/tiny_mce/changelog.txt", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/icons/default/icons.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/jquery.tinymce.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/langs/readme.md", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/license.txt", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/models/dom/model.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/advlist/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/anchor/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/autolink/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/autoresize/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/autosave/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/bbcode/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/charmap/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/code/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/codesample/css/prism.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/codesample/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/colorpicker/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/contextmenu/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/directionality/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/emoticons/img/smiley-cool.gif", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/emoticons/img/smiley-cry.gif", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/emoticons/img/smiley-embarassed.gif", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/emoticons/img/smiley-foot-in-mouth.gif", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/emoticons/img/smiley-frown.gif", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/emoticons/img/smiley-innocent.gif", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/emoticons/img/smiley-kiss.gif", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/emoticons/img/smiley-laughing.gif", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/emoticons/img/smiley-money-mouth.gif", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/emoticons/img/smiley-sealed.gif", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/emoticons/img/smiley-smile.gif", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/emoticons/img/smiley-surprised.gif", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/emoticons/img/smiley-tongue-out.gif", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/emoticons/img/smiley-undecided.gif", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/emoticons/img/smiley-wink.gif", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/emoticons/img/smiley-yell.gif", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/emoticons/js/emojiimages.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/emoticons/js/emojiimages.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/emoticons/js/emojis.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/emoticons/js/emojis.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/emoticons/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/fullpage/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/fullscreen/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/help/img/logo.png", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/help/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/hr/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/image/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/imagetools/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/importcss/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/insertdatetime/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/legacyoutput/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/link/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/lists/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/media/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/nonbreaking/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/noneditable/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/pagebreak/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/paste/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/preview/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/print/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/quickbars/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/save/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/searchreplace/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/spellchecker/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/tabfocus/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/table/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/template/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/textcolor/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/textpattern/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/toc/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/visualblocks/css/visualblocks.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/visualblocks/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/visualchars/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/plugins/wordcount/plugin.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/content/dark/content.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/content/default/content.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/content/document/content.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/content/tinymce-5-dark/content.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/content/tinymce-5/content.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/content/writer/content.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/lightgray/content.inline.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/lightgray/content.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/lightgray/content.mobile.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/lightgray/fonts/tinymce-mobile.woff", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/lightgray/fonts/tinymce-small.eot", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/lightgray/fonts/tinymce-small.svg", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/lightgray/fonts/tinymce-small.ttf", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/lightgray/fonts/tinymce-small.woff", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/lightgray/fonts/tinymce.eot", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/lightgray/fonts/tinymce.svg", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/lightgray/fonts/tinymce.ttf", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/lightgray/fonts/tinymce.woff", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/lightgray/img/anchor.gif", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/lightgray/img/loader.gif", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/lightgray/img/object.gif", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/lightgray/img/trans.gif", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/lightgray/skin.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/lightgray/skin.mobile.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/ui/oxide-dark/content.inline.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/ui/oxide-dark/content.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/ui/oxide-dark/skin.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/ui/oxide-dark/skin.shadowdom.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/ui/oxide/content.inline.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/ui/oxide/content.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/ui/oxide/skin.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/ui/oxide/skin.shadowdom.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/ui/tinymce-5-dark/content.inline.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/ui/tinymce-5-dark/content.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/ui/tinymce-5-dark/skin.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/ui/tinymce-5-dark/skin.shadowdom.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/ui/tinymce-5/content.inline.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/ui/tinymce-5/content.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/ui/tinymce-5/skin.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/skins/ui/tinymce-5/skin.shadowdom.min.css", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/themes/inlite/theme.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/themes/mobile/theme.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/themes/modern/theme.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/themes/silver/theme.min.js", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/tinymce.d.ts", "wflow-consoleweb/src/main/webapp/js/tiny_mce/js/tinymce/tinymce.min.js", "wflow-consoleweb/src/main/webapp/progressive/js/main.js", "wflow-consoleweb/src/main/webapp/universal/js/main.js"]}, {"commit_id": "14b9e83b588f7f042bbaf035cf4812f02f6ec030", "commit_date": "Mon Dec 5 08:36:23 2022 +0800", "commit_message": "Fixed: wflow-wfengine - Process - Tool abort itself using JSON API but process still continue to next activity. T1513 @7.0-SNAPSHOT", "files_name": ["wflow-wfengine/src/main/java/org/enhydra/shark/CustomWfActivityImpl.java"]}, {"commit_id": "0d2e8d55b77ff2d7df1eef13d06bddf6eb428e25", "commit_date": "Mon Dec 5 08:38:27 2022 +0800", "commit_message": "Fixed: wflow-wfengine - Workflow Manager - Process completed checking run even when activity on created and running state. T1513 @7.0-SNAPSHOT", "files_name": ["wflow-wfengine/src/main/java/org/joget/workflow/shark/WorkflowEventAuditManager.java"]}, {"commit_id": "252f63cca7a805c2d40c0b1b8dd0c383d68411b3", "commit_date": "Mon Dec 5 08:54:32 2022 +0800", "commit_message": "Modified: wflow-core - JSON Tool - Added {} annotation to handle the keys which contains \".\". @7.0-SNAPSHOT", "files_name": ["bcd483e7afe1bec6b8d2dbc0f1ed7197bc0bc6dd - Mon Dec 5 00:58:27 2022 +0000 : Merge branch '7.0-SNAPSHOT' of github.com:jogetworkflow/jw-community into 7.0-SNAPSHOT", "32b9888579215ebeaea2faba3f288d4b7db265cb - Mon Dec 5 18:41:06 2022 +0800 : Fixed: wflow-core - Date Picker - Date picker can't work with date limit when the date format is without day syntax. T1673 @7.0-SNAPSHOT", "wflow-core/src/main/resources/resources/js/jquery.custom.datepicker.js"]}, {"commit_id": "7e67c2609d797b80aa840ea25d9f7f2ef6f0b41a", "commit_date": "Tue Dec 6 12:32:09 2022 +0800", "commit_message": "Fixed: jw-community - Update jQuery UI to 1.13.2 for CVE-2022-31160. @7.0-SNAPSHOT", "files_name": ["wflow-consoleweb/src/main/resources/wro.xml", "wflow-consoleweb/src/main/webapp/WEB-INF/jsp/dbuilder/view.jsp", "wflow-consoleweb/src/main/webapp/WEB-INF/jsp/pbuilder/pbuilder.jsp", "wflow-consoleweb/src/main/webapp/WEB-INF/jsp/pbuilder/pmapper.jsp", "wflow-consoleweb/src/main/webapp/WEB-INF/jsp/pbuilder/pscreenshot.jsp", "wflow-consoleweb/src/main/webapp/WEB-INF/jsp/pbuilder/pviewer.jsp", "wflow-consoleweb/src/main/webapp/css/userview.css", "wflow-consoleweb/src/main/webapp/css/userview_v5.css", "wflow-consoleweb/src/main/webapp/css/v7.css", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/animated-overlay.gif", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-bg_flat_0_aaaaaa_40x100.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-bg_flat_75_ffffff_40x100.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-bg_glass_55_fbf9ee_1x400.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-bg_glass_65_ffffff_1x400.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-bg_glass_75_dadada_1x400.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-bg_glass_75_e6e6e6_1x400.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-bg_glass_95_fef1ec_1x400.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-bg_highlight-soft_75_fff_1x100.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_222222_256x240.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_2e83ff_256x240.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_444444_256x240.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_454545_256x240.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_555555_256x240.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_777620_256x240.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_777777_256x240.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_888888_256x240.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_cc0000_256x240.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_cd0a0a_256x240.png", "wflow-consoleweb/src/main/webapp/js/jquery/themes/ui-lightness/images/ui-icons_ffffff_256x240.png"]}], "parents": [{"commit_id_before": "2e33ea3bcaf33fd554a2cb5323b7ecf58975236a", "url_before": "https://api.github.com/repos/jogetworkflow/jw-community/commits/2e33ea3bcaf33fd554a2cb5323b7ecf58975236a", "html_url_before": "https://github.com/jogetworkflow/jw-community/commit/2e33ea3bcaf33fd554a2cb5323b7ecf58975236a"}], "details": [{"raw_url": "https://github.com/jogetworkflow/jw-community/raw/9a77f508a2bf8cf661d588f37a4cc29ecaea4fc8/wflow-core%2Fsrc%2Fmain%2Fjava%2Forg%2Fjoget%2Fplugin%2Fenterprise%2FUserProfileMenu.java", "code": "package org.joget.plugin.enterprise;\n\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Collection;\nimport java.util.HashMap;\nimport java.util.HashSet;\nimport java.util.Locale;\nimport java.util.Map;\nimport java.util.TreeMap;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpSession;\nimport org.joget.apps.app.service.AppUtil;\nimport org.joget.apps.userview.model.UserviewBuilderPalette;\nimport org.joget.apps.userview.model.UserviewMenu;\nimport org.joget.commons.util.ResourceBundleUtil;\nimport org.joget.commons.util.SecurityUtil;\nimport org.joget.commons.util.SetupManager;\nimport org.joget.commons.util.StringUtil;\nimport org.joget.commons.util.TimeZoneUtil;\nimport org.joget.directory.dao.UserDao;\nimport org.joget.directory.model.User;\nimport org.joget.directory.model.service.DirectoryUtil;\nimport org.joget.directory.model.service.ExtDirectoryManager;\nimport org.joget.directory.model.service.UserSecurity;\nimport org.joget.plugin.base.PluginManager;\nimport org.joget.workflow.model.service.WorkflowUserManager;\nimport org.joget.workflow.util.WorkflowUtil;\nimport org.springframework.beans.BeanUtils;\nimport org.springframework.context.ApplicationContext;\n\npublic class UserProfileMenu extends UserviewMenu {\n\n    @Override\n    public String getClassName() {\n        return getClass().getName();\n    }\n\n    @Override\n    public String getLabel() {\n        return \"User Profile\";\n    }\n\n    @Override\n    public String getIcon() {\n        return \"<i class=\\\"fas fa-user-edit\\\"></i>\";\n    }\n\n    public String getName() {\n        return \"User Profile Menu\";\n    }\n\n    public String getVersion() {\n        return \"5.0.0\";\n    }\n\n    public String getDescription() {\n        return \"\";\n    }\n\n    public String getPropertyOptions() {\n        return AppUtil.readPluginResource(getClass().getName(), \"/properties/userview/userProfileMenu.json\", null, true, \"message/userview/userProfileMenu\");\n    }\n\n    @Override\n    public String getDecoratedMenu() {\n        if (\"true\".equals(getRequestParameter(\"isPreview\")) || \"Yes\".equals(getPropertyString(\"showInPopupDialog\"))) {\n            // sanitize label\n            String label = getPropertyString(\"label\");\n            if (label != null) {\n                label = StringUtil.stripHtmlRelaxed(label);\n            }\n\n            String menu = \"<a onclick=\\\"menu_\" + getPropertyString(\"id\") + \"_showDialog();return false;\\\" class=\\\"menu-link\\\"><span>\" + label + \"</span></a>\";\n            menu += \"<script>\\n\";\n\n            if (\"Yes\".equals(getPropertyString(\"showInPopupDialog\"))) {\n                String url = getUrl() + \"?embed=true\";\n\n                menu += \"var menu_\" + getPropertyString(\"id\") + \"Dialog = new PopupDialog(\\\"\" + url + \"\\\",\\\"\\\");\\n\";\n            }\n            menu += \"function menu_\" + getPropertyString(\"id\") + \"_showDialog(){\\n\";\n            if (\"true\".equals(getRequestParameter(\"isPreview\"))) {\n                menu += \"alert('Feature disabled in Preview Mode.');\\n\";\n            } else {\n                menu += \"menu_\" + getPropertyString(\"id\") + \"Dialog.init();\\n\";\n            }\n            menu += \"}\\n</script>\";\n            return menu;\n        }\n        return null;\n    }\n\n    @Override\n    public boolean isHomePageSupported() {\n        return true;\n    }\n\n    @Override\n    public String getRenderPage() {\n        if (\"true\".equals(getRequestParameterString(\"isPreview\"))) {\n            setProperty(\"isPreview\", \"true\");\n        } else {\n            if (\"submit\".equals(getRequestParameterString(\"action\"))) {\n                // only allow POST\n                HttpServletRequest request = WorkflowUtil.getHttpServletRequest();\n                if (request != null && !\"POST\".equalsIgnoreCase(request.getMethod())) {\n                    PluginManager pluginManager = (PluginManager)AppUtil.getApplicationContext().getBean(\"pluginManager\");\n                    String content = pluginManager.getPluginFreeMarkerTemplate(new HashMap(), getClass().getName(), \"/templates/unauthorized.ftl\", null);\n                    return content;\n                }\n\n                submitForm();\n            } else {\n                viewForm(null);\n            }\n        }\n        Map model = new HashMap();\n        model.put(\"request\", getRequestParameters());\n        model.put(\"element\", this);\n        \n        PluginManager pluginManager = (PluginManager)AppUtil.getApplicationContext().getBean(\"pluginManager\");\n        String content = pluginManager.getPluginFreeMarkerTemplate(model, getClass().getName(), \"/templates/userProfile.ftl\", null);\n        return content;\n    }\n    \n    private void viewForm(User submittedData) {\n        setProperty(\"headerTitle\", getPropertyString(\"label\"));\n        setProperty(\"view\", \"formView\");\n\n        ApplicationContext ac = AppUtil.getApplicationContext();\n        WorkflowUserManager workflowUserManager = (WorkflowUserManager) ac.getBean(\"workflowUserManager\");\n        UserDao userDao = (UserDao) ac.getBean(\"userDao\");\n        User user = submittedData;\n        if (user == null) {\n            user = userDao.getUser(workflowUserManager.getCurrentUsername());\n        }\n        if (user != null && user.getReadonly()) {\n            return;\n        }\n        setProperty(\"user\", user);\n        setProperty(\"timezones\", TimeZoneUtil.getList());\n        \n        SetupManager setupManager = (SetupManager) ac.getBean(\"setupManager\");\n        String enableUserLocale = setupManager.getSettingValue(\"enableUserLocale\");\n        Map<String, String> localeStringList = new TreeMap<String, String>();\n        if(enableUserLocale != null && enableUserLocale.equalsIgnoreCase(\"true\")) {\n            String userLocale = setupManager.getSettingValue(\"userLocale\");\n            Collection<String> locales = new HashSet();\n            locales.addAll(Arrays.asList(userLocale.split(\",\")));\n            \n            Locale[] localeList = Locale.getAvailableLocales();\n            for (int x = 0; x < localeList.length; x++) {\n                String code = localeList[x].toString();\n                if (locales.contains(code)) {\n                    localeStringList.put(code, code + \" - \" +localeList[x].getDisplayName());\n                }\n            }\n        }\n        setProperty(\"enableUserLocale\", enableUserLocale);\n        setProperty(\"localeStringList\", localeStringList);\n        \n        UserSecurity us = DirectoryUtil.getUserSecurity();\n        if (us != null) {\n            setProperty(\"policies\", us.passwordPolicies());\n            setProperty(\"userProfileFooter\", us.getUserProfileFooter(user));\n        }\n        \n        String url = getUrl() + \"?action=submit\";\n        setProperty(\"actionUrl\", url);\n    }\n\n    private void submitForm() {\n        ApplicationContext ac = AppUtil.getApplicationContext();\n        WorkflowUserManager workflowUserManager = (WorkflowUserManager) ac.getBean(\"workflowUserManager\");\n        UserDao userDao = (UserDao) ac.getBean(\"userDao\");\n        User userObject = userDao.getUser(workflowUserManager.getCurrentUsername());\n        User currentUser = null;\n        if (userObject != null) {\n            currentUser = new User();\n            BeanUtils.copyProperties(userObject, currentUser);\n        }\n        ExtDirectoryManager directoryManager = (ExtDirectoryManager) AppUtil.getApplicationContext().getBean(\"directoryManager\");\n           \n        Collection<String> errors = new ArrayList<String>();\n        Collection<String> passwordErrors = new ArrayList<String>();\n        \n        boolean authenticated = false;\n        if (currentUser != null) {\n            if (!currentUser.getUsername().equals(getRequestParameterString(\"username\"))) {\n                HttpServletRequest request = WorkflowUtil.getHttpServletRequest();\n                if (request != null) {\n                    HttpSession session = request.getSession(false);\n                    if (session != null) {\n                        session.invalidate();\n                        authenticated = false;\n                    }\n                }\n            } else {\n                try {\n                    if (directoryManager.authenticate(currentUser.getUsername(), getRequestParameterString(\"oldPassword\"))) {\n                        authenticated = true;\n                    }\n                } catch (Exception e) { }\n            }\n        }\n        UserSecurity us = DirectoryUtil.getUserSecurity();\n        \n        if (\"\".equals(getPropertyString(\"f_firstName\")) && !StringUtil.stripAllHtmlTag(getRequestParameterString(\"firstName\")).isEmpty()) {\n            currentUser.setFirstName(StringUtil.stripAllHtmlTag(getRequestParameterString(\"firstName\")));\n        }\n\n        if (\"\".equals(getPropertyString(\"f_lastName\"))) {\n            currentUser.setLastName(StringUtil.stripAllHtmlTag(getRequestParameterString(\"lastName\")));\n        }\n\n        if (\"\".equals(getPropertyString(\"f_email\"))) {\n            currentUser.setEmail(getRequestParameterString(\"email\"));\n        }\n\n        if (\"\".equals(getPropertyString(\"f_timeZone\"))) {\n            currentUser.setTimeZone(getRequestParameterString(\"timeZone\"));\n        }\n\n        if (\"\".equals(getPropertyString(\"f_locale\"))) {\n            currentUser.setLocale(getRequestParameterString(\"locale\"));\n        }\n\n        if (!authenticated) {\n            if (errors == null) {\n                errors = new ArrayList<String>();\n            }\n            errors.add(ResourceBundleUtil.getMessage(\"console.directory.user.error.label.authenticationFailed\"));\n        } else {\n            if (us != null) {\n                errors = us.validateUserOnProfileUpdate(currentUser);\n            }\n\n            if (getRequestParameterString(\"password\") != null && !getRequestParameterString(\"password\").isEmpty() && us != null) {\n                passwordErrors = us.validatePassword(getRequestParameterString(\"username\"),  getRequestParameterString(\"oldPassword\"), getRequestParameterString(\"password\"), getRequestParameterString(\"confirmPassword\")); \n            }\n        }\n\n        setProperty(\"errors\", errors);\n        if (passwordErrors != null && !passwordErrors.isEmpty()) {\n            setProperty(\"passwordErrors\", passwordErrors);\n        }\n        \n        if (authenticated && (passwordErrors != null && passwordErrors.isEmpty()) && (errors != null && errors.isEmpty())) {\n            if (\"\".equals(getPropertyString(\"f_password\"))) {\n                if (getRequestParameterString(\"password\") != null && getRequestParameterString(\"confirmPassword\") != null && getRequestParameterString(\"password\").length() > 0 && getRequestParameterString(\"password\").equals(getRequestParameterString(\"confirmPassword\"))) {\n                    if (us != null) {\n                        currentUser.setPassword(us.encryptPassword(getRequestParameterString(\"username\"), getRequestParameterString(\"password\")));\n                    } else {\n                        currentUser.setPassword(StringUtil.md5Base16(getRequestParameterString(\"password\")));\n                    }\n                    currentUser.setConfirmPassword(getRequestParameterString(\"password\"));\n                }\n            }\n\n            if (currentUser.getUsername().equals(getRequestParameterString(\"username\"))) {\n                userDao.updateUser(currentUser);\n                if (us != null) {\n                    us.updateUserProfilePostProcessing(currentUser);\n                }\n                \n                setAlertMessage(getPropertyString(\"message\"));\n                setProperty(\"headerTitle\", getPropertyString(\"label\"));\n                if (getPropertyString(\"redirectURL\") != null && !getPropertyString(\"redirectURL\").isEmpty()) {\n                    setProperty(\"view\", \"redirect\");\n                    boolean redirectToParent = \"Yes\".equals(getPropertyString(\"showInPopupDialog\"));\n                    setRedirectUrl(getPropertyString(\"redirectURL\"), redirectToParent);\n                } else {\n                    setProperty(\"saved\", \"true\");\n                    viewForm(null);\n                }\n            }\n        } else {\n            viewForm(currentUser);\n        }\n    }\n\n    @Override\n    public String getCategory() {\n        return UserviewBuilderPalette.CATEGORY_GENERAL;\n    }\n}\n", "code_before": "package org.joget.plugin.enterprise;\n\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Collection;\nimport java.util.HashMap;\nimport java.util.HashSet;\nimport java.util.Locale;\nimport java.util.Map;\nimport java.util.TreeMap;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpSession;\nimport org.joget.apps.app.service.AppUtil;\nimport org.joget.apps.userview.model.UserviewBuilderPalette;\nimport org.joget.apps.userview.model.UserviewMenu;\nimport org.joget.commons.util.ResourceBundleUtil;\nimport org.joget.commons.util.SetupManager;\nimport org.joget.commons.util.StringUtil;\nimport org.joget.commons.util.TimeZoneUtil;\nimport org.joget.directory.dao.UserDao;\nimport org.joget.directory.model.User;\nimport org.joget.directory.model.service.DirectoryUtil;\nimport org.joget.directory.model.service.ExtDirectoryManager;\nimport org.joget.directory.model.service.UserSecurity;\nimport org.joget.plugin.base.PluginManager;\nimport org.joget.workflow.model.service.WorkflowUserManager;\nimport org.joget.workflow.util.WorkflowUtil;\nimport org.springframework.beans.BeanUtils;\nimport org.springframework.context.ApplicationContext;\n\npublic class UserProfileMenu extends UserviewMenu {\n\n    @Override\n    public String getClassName() {\n        return getClass().getName();\n    }\n\n    @Override\n    public String getLabel() {\n        return \"User Profile\";\n    }\n\n    @Override\n    public String getIcon() {\n        return \"<i class=\\\"fas fa-user-edit\\\"></i>\";\n    }\n\n    public String getName() {\n        return \"User Profile Menu\";\n    }\n\n    public String getVersion() {\n        return \"5.0.0\";\n    }\n\n    public String getDescription() {\n        return \"\";\n    }\n\n    public String getPropertyOptions() {\n        return AppUtil.readPluginResource(getClass().getName(), \"/properties/userview/userProfileMenu.json\", null, true, \"message/userview/userProfileMenu\");\n    }\n\n    @Override\n    public String getDecoratedMenu() {\n        if (\"true\".equals(getRequestParameter(\"isPreview\")) || \"Yes\".equals(getPropertyString(\"showInPopupDialog\"))) {\n            // sanitize label\n            String label = getPropertyString(\"label\");\n            if (label != null) {\n                label = StringUtil.stripHtmlRelaxed(label);\n            }\n\n            String menu = \"<a onclick=\\\"menu_\" + getPropertyString(\"id\") + \"_showDialog();return false;\\\" class=\\\"menu-link\\\"><span>\" + label + \"</span></a>\";\n            menu += \"<script>\\n\";\n\n            if (\"Yes\".equals(getPropertyString(\"showInPopupDialog\"))) {\n                String url = getUrl() + \"?embed=true\";\n\n                menu += \"var menu_\" + getPropertyString(\"id\") + \"Dialog = new PopupDialog(\\\"\" + url + \"\\\",\\\"\\\");\\n\";\n            }\n            menu += \"function menu_\" + getPropertyString(\"id\") + \"_showDialog(){\\n\";\n            if (\"true\".equals(getRequestParameter(\"isPreview\"))) {\n                menu += \"alert('Feature disabled in Preview Mode.');\\n\";\n            } else {\n                menu += \"menu_\" + getPropertyString(\"id\") + \"Dialog.init();\\n\";\n            }\n            menu += \"}\\n</script>\";\n            return menu;\n        }\n        return null;\n    }\n\n    @Override\n    public boolean isHomePageSupported() {\n        return true;\n    }\n\n    @Override\n    public String getRenderPage() {\n        if (\"true\".equals(getRequestParameterString(\"isPreview\"))) {\n            setProperty(\"isPreview\", \"true\");\n        } else {\n            if (\"submit\".equals(getRequestParameterString(\"action\"))) {\n                // only allow POST\n                HttpServletRequest request = WorkflowUtil.getHttpServletRequest();\n                if (request != null && !\"POST\".equalsIgnoreCase(request.getMethod())) {\n                    PluginManager pluginManager = (PluginManager)AppUtil.getApplicationContext().getBean(\"pluginManager\");\n                    String content = pluginManager.getPluginFreeMarkerTemplate(new HashMap(), getClass().getName(), \"/templates/unauthorized.ftl\", null);\n                    return content;\n                }\n\n                submitForm();\n            } else {\n                viewForm(null);\n            }\n        }\n        Map model = new HashMap();\n        model.put(\"request\", getRequestParameters());\n        model.put(\"element\", this);\n        \n        PluginManager pluginManager = (PluginManager)AppUtil.getApplicationContext().getBean(\"pluginManager\");\n        String content = pluginManager.getPluginFreeMarkerTemplate(model, getClass().getName(), \"/templates/userProfile.ftl\", null);\n        return content;\n    }\n    \n    private void viewForm(User submittedData) {\n        setProperty(\"headerTitle\", getPropertyString(\"label\"));\n        setProperty(\"view\", \"formView\");\n\n        ApplicationContext ac = AppUtil.getApplicationContext();\n        WorkflowUserManager workflowUserManager = (WorkflowUserManager) ac.getBean(\"workflowUserManager\");\n        UserDao userDao = (UserDao) ac.getBean(\"userDao\");\n        User user = submittedData;\n        if (user == null) {\n            user = userDao.getUser(workflowUserManager.getCurrentUsername());\n        }\n        if (user != null && user.getReadonly()) {\n            return;\n        }\n        setProperty(\"user\", user);\n        setProperty(\"timezones\", TimeZoneUtil.getList());\n        \n        SetupManager setupManager = (SetupManager) ac.getBean(\"setupManager\");\n        String enableUserLocale = setupManager.getSettingValue(\"enableUserLocale\");\n        Map<String, String> localeStringList = new TreeMap<String, String>();\n        if(enableUserLocale != null && enableUserLocale.equalsIgnoreCase(\"true\")) {\n            String userLocale = setupManager.getSettingValue(\"userLocale\");\n            Collection<String> locales = new HashSet();\n            locales.addAll(Arrays.asList(userLocale.split(\",\")));\n            \n            Locale[] localeList = Locale.getAvailableLocales();\n            for (int x = 0; x < localeList.length; x++) {\n                String code = localeList[x].toString();\n                if (locales.contains(code)) {\n                    localeStringList.put(code, code + \" - \" +localeList[x].getDisplayName());\n                }\n            }\n        }\n        setProperty(\"enableUserLocale\", enableUserLocale);\n        setProperty(\"localeStringList\", localeStringList);\n        \n        UserSecurity us = DirectoryUtil.getUserSecurity();\n        if (us != null) {\n            setProperty(\"policies\", us.passwordPolicies());\n            setProperty(\"userProfileFooter\", us.getUserProfileFooter(user));\n        }\n        \n        String url = getUrl() + \"?action=submit\";\n        setProperty(\"actionUrl\", url);\n    }\n\n    private void submitForm() {\n        ApplicationContext ac = AppUtil.getApplicationContext();\n        WorkflowUserManager workflowUserManager = (WorkflowUserManager) ac.getBean(\"workflowUserManager\");\n        UserDao userDao = (UserDao) ac.getBean(\"userDao\");\n        User userObject = userDao.getUser(workflowUserManager.getCurrentUsername());\n        User currentUser = null;\n        if (userObject != null) {\n            currentUser = new User();\n            BeanUtils.copyProperties(userObject, currentUser);\n        }\n        ExtDirectoryManager directoryManager = (ExtDirectoryManager) AppUtil.getApplicationContext().getBean(\"directoryManager\");\n           \n        Collection<String> errors = new ArrayList<String>();\n        Collection<String> passwordErrors = new ArrayList<String>();\n        \n        boolean authenticated = false;\n        if (currentUser != null) {\n            if (!currentUser.getUsername().equals(getRequestParameterString(\"username\"))) {\n                HttpServletRequest request = WorkflowUtil.getHttpServletRequest();\n                if (request != null) {\n                    HttpSession session = request.getSession(false);\n                    if (session != null) {\n                        session.invalidate();\n                        authenticated = false;\n                    }\n                }\n            } else {\n                try {\n                    if (directoryManager.authenticate(currentUser.getUsername(), getRequestParameterString(\"oldPassword\"))) {\n                        authenticated = true;\n                    }\n                } catch (Exception e) { }\n            }\n        }\n        UserSecurity us = DirectoryUtil.getUserSecurity();\n        \n        if (\"\".equals(getPropertyString(\"f_firstName\"))) {\n            currentUser.setFirstName(getRequestParameterString(\"firstName\"));\n        }\n\n        if (\"\".equals(getPropertyString(\"f_lastName\"))) {\n            currentUser.setLastName(getRequestParameterString(\"lastName\"));\n        }\n\n        if (\"\".equals(getPropertyString(\"f_email\"))) {\n            currentUser.setEmail(getRequestParameterString(\"email\"));\n        }\n\n        if (\"\".equals(getPropertyString(\"f_timeZone\"))) {\n            currentUser.setTimeZone(getRequestParameterString(\"timeZone\"));\n        }\n\n        if (\"\".equals(getPropertyString(\"f_locale\"))) {\n            currentUser.setLocale(getRequestParameterString(\"locale\"));\n        }\n\n        if (!authenticated) {\n            if (errors == null) {\n                errors = new ArrayList<String>();\n            }\n            errors.add(ResourceBundleUtil.getMessage(\"console.directory.user.error.label.authenticationFailed\"));\n        } else {\n            if (us != null) {\n                errors = us.validateUserOnProfileUpdate(currentUser);\n            }\n\n            if (getRequestParameterString(\"password\") != null && !getRequestParameterString(\"password\").isEmpty() && us != null) {\n                passwordErrors = us.validatePassword(getRequestParameterString(\"username\"),  getRequestParameterString(\"oldPassword\"), getRequestParameterString(\"password\"), getRequestParameterString(\"confirmPassword\")); \n            }\n        }\n\n        setProperty(\"errors\", errors);\n        if (passwordErrors != null && !passwordErrors.isEmpty()) {\n            setProperty(\"passwordErrors\", passwordErrors);\n        }\n        \n        if (authenticated && (passwordErrors != null && passwordErrors.isEmpty()) && (errors != null && errors.isEmpty())) {\n            if (\"\".equals(getPropertyString(\"f_password\"))) {\n                if (getRequestParameterString(\"password\") != null && getRequestParameterString(\"confirmPassword\") != null && getRequestParameterString(\"password\").length() > 0 && getRequestParameterString(\"password\").equals(getRequestParameterString(\"confirmPassword\"))) {\n                    if (us != null) {\n                        currentUser.setPassword(us.encryptPassword(getRequestParameterString(\"username\"), getRequestParameterString(\"password\")));\n                    } else {\n                        currentUser.setPassword(StringUtil.md5Base16(getRequestParameterString(\"password\")));\n                    }\n                    currentUser.setConfirmPassword(getRequestParameterString(\"password\"));\n                }\n            }\n\n            if (currentUser.getUsername().equals(getRequestParameterString(\"username\"))) {\n                userDao.updateUser(currentUser);\n                if (us != null) {\n                    us.updateUserProfilePostProcessing(currentUser);\n                }\n                \n                setAlertMessage(getPropertyString(\"message\"));\n                setProperty(\"headerTitle\", getPropertyString(\"label\"));\n                if (getPropertyString(\"redirectURL\") != null && !getPropertyString(\"redirectURL\").isEmpty()) {\n                    setProperty(\"view\", \"redirect\");\n                    boolean redirectToParent = \"Yes\".equals(getPropertyString(\"showInPopupDialog\"));\n                    setRedirectUrl(getPropertyString(\"redirectURL\"), redirectToParent);\n                } else {\n                    setProperty(\"saved\", \"true\");\n                    viewForm(null);\n                }\n            }\n        } else {\n            viewForm(currentUser);\n        }\n    }\n\n    @Override\n    public String getCategory() {\n        return UserviewBuilderPalette.CATEGORY_GENERAL;\n    }\n}\n", "patch": "@@ -14,6 +14,7 @@\n import org.joget.apps.userview.model.UserviewBuilderPalette;\n import org.joget.apps.userview.model.UserviewMenu;\n import org.joget.commons.util.ResourceBundleUtil;\n+import org.joget.commons.util.SecurityUtil;\n import org.joget.commons.util.SetupManager;\n import org.joget.commons.util.StringUtil;\n import org.joget.commons.util.TimeZoneUtil;\n@@ -205,12 +206,12 @@ private void submitForm() {\n         }\n         UserSecurity us = DirectoryUtil.getUserSecurity();\n         \n-        if (\"\".equals(getPropertyString(\"f_firstName\"))) {\n-            currentUser.setFirstName(getRequestParameterString(\"firstName\"));\n+        if (\"\".equals(getPropertyString(\"f_firstName\")) && !StringUtil.stripAllHtmlTag(getRequestParameterString(\"firstName\")).isEmpty()) {\n+            currentUser.setFirstName(StringUtil.stripAllHtmlTag(getRequestParameterString(\"firstName\")));\n         }\n \n         if (\"\".equals(getPropertyString(\"f_lastName\"))) {\n-            currentUser.setLastName(getRequestParameterString(\"lastName\"));\n+            currentUser.setLastName(StringUtil.stripAllHtmlTag(getRequestParameterString(\"lastName\")));\n         }\n \n         if (\"\".equals(getPropertyString(\"f_email\"))) {", "file_path": "files/2022_12/83", "file_language": "java", "file_name": "wflow-core/src/main/java/org/joget/plugin/enterprise/UserProfileMenu.java", "outdated_file_modify": 0, "outdated_file_before": 0, "outdated_file_after": 0, "llm_check": 1, "static_check": 0, "static": {"semgrep": [false, []]}, "target": -1, "function_before": [], "function_after": []}], "outdated": 0, "cwe_descripiton": "", "cwe_consequence": "", "cwe_method": "", "cwe_solution": ""}